!function(e){"use strict";e.module("esri.map",[]),e.module("esri.map").factory("esriLoader",["$q",function(e){return function(t){var r=e.defer();return require([t],function(e){e?r.resolve(e):r.reject("Couldn't load "+t)}),r.promise}}])}(angular),function(e){"use strict";e.module("esri.map").service("esriRegistry",["$q",function(e){var t={};return{_register:function(r,n){t[r]||(t[r]=e.defer());var i=t[r];return n.promise.then(function(e){return i.resolve(e),e},function(e){return i.reject(e),e}),function(){delete t[r]}},get:function(r){if(t[r])return t[r].promise;var n=e.defer();return t[r]=n,n.promise}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",["$q","$timeout","esriLoader","esriRegistry",function(e,t,r,n){return{restrict:"E",scope:{center:"=?",zoom:"=?",itemInfo:"=?",clickPoint:"=?",basemap:"@",load:"&",extentChange:"&"},compile:function(e,t){return e.removeAttr("id"),e.append("<div id="+t.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(r,i,a){var o=e.defer();if(a.registerAs){var s=n._register(a.registerAs,o);r.$on("$destroy",s)}require(["esri/map","esri/arcgis/utils"],function(e,n){if(a.webmapId)n.createMap(a.webmapId,a.id).then(function(e){o.resolve(e.map);var t=e.map.geographicExtent.getCenter();r.center.lng=t.x,r.center.lat=t.y,r.zoom=e.map.getZoom(),r.itemInfo=e.itemInfo});else{var i={};a.extent?i.extent=r[a.extent]:(r.center.lng&&r.center.lat?i.center=[r.center.lng,r.center.lat]:r.center&&(i.center=r.center),r.zoom&&(i.zoom=r.zoom)),r.basemap&&(i.basemap=r.basemap);var s=new e(a.id,i);o.resolve(s)}o.promise.then(function(e){e.on("load",function(){a.load&&r.$apply(function(){r.load()(e)})}),r.$watch("basemap",function(t,r){e.loaded&&t!==r&&e.setBasemap(t)}),r.inUpdateCycle=!1,r.$watch(function(e){return[e.center.lng,e.center.lat,e.zoom].join(",")},function(t){r.inUpdateCycle||(t=t.split(","),""!==t[0]&&""!==t[1]&&""!==t[2]&&(r.inUpdateCycle=!0,e.centerAndZoom([t[0],t[1]],t[2]).then(function(){r.inUpdateCycle=!1})))}),e.on("extent-change",function(n){r.inUpdateCycle||(r.inUpdateCycle=!0,r.$apply(function(){var i=e.geographicExtent.getCenter();r.center.lng=i.x,r.center.lat=i.y,r.zoom=e.getZoom(),a.extentChange&&r.extentChange()(n),t(function(){r.inUpdateCycle=!1},0)}))}),void 0!==r.clickPoint&&e.on("click",function(e){r.$apply(function(){r.clickPoint=e.mapPoint})}),r.$on("$destroy",function(){e.destroy()})})}),this.getMap=function(){return o.promise},this.addLayer=function(e){return this.getMap().then(function(t){return t.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriGp",["$q",function(e){return{restrict:"E",require:["esriGp","^esriMap"],replace:!0,scope:{parameters:"=?",state:"=?",messages:"=?"},controller:["$scope","$element","$attrs","$http",function(t,r,n,i){var a=e.defer(),o=null;t.state="initalizing",require(["esri/tasks/Geoprocessor"],function(e){var t=new e(n.url);t.setOutputSpatialReference({wkid:102100}),i.jsonp(n.url+"?f=json&callback=JSON_CALLBACK").success(function(e){o=e,a.resolve(t)}).error(function(e,t){a.reject(t)})}),this.getGp=function(){return a.promise},this.getGpDescription=function(){return o}}],link:function(e,t,r,n){var i=n[0],a=n[1];i.getGp().then(function(){{var t=i.getGpDescription();t.parameters.filter(function(e){return"esriGPParameterDirectionInput"===e.direction}),t.parameters.filter(function(e){return"esriGPParameterDirectionOutput"===e.direction})}e.state="ready"}),e.$watch("parameters",function(t){null!==t&&require(["esri/graphic","esri/tasks/FeatureSet","esri/graphicsUtils","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","dojo/_base/Color"],function(r,n,o,s,c,u,l){var p={};a.getMap().then(function(a){a.graphics&&a.graphics.clear();for(var f in t){if(null===t[f])return;if("point"===t[f].type){var d=new s;d.setSize(14),d.setOutline(new c(c.STYLE_SOLID,new l([255,0,0]),1)),d.setColor(new l([255,255,0,.75]));var m=new r(t[f],d),y=new n;y.features=[m],p[f]=y,a.graphics.add(m)}else p[f]=t[f]}i.getGp().then(function(t){e.state="working",t.setOutputSpatialReference(a.spatialReference),t.execute(p,function(t,r){var n=new s;n.setSize(14),n.setOutline(new c(c.STYLE_SOLID,new l([255,0,0]),1)),n.setColor(new l([255,0,0,.75]));var i=new u;i.setOutline(new c(c.STYLE_SOLID,new l([0,0,255,.5]),1)),i.setColor(new l([0,127,255,.6]));for(var p=0;p<t.length;p++)for(var f=t[p].value.features,d=0,m=f.length;m>d;d++){var y=f[d];switch(t[p].value.geometryType){case"esriGeometryPoint":y.setSymbol(n);break;case"esriGeometryPolygon":y.setSymbol(i)}a.graphics.add(y).getDojoShape().moveToBack()}a.setExtent(o.graphicsExtent(a.graphics.graphics),!0),e.$apply(function(){e.messages=r,e.state="ready"})})})})})},!0)}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(t,r,n){var i=e.defer();require(["esri/layers/FeatureLayer"],function(e){var t=new e(n.url);i.resolve(t)}),this.getLayer=function(){return i.promise}}],link:function(e,t,r,n){var i=n[0],a=n[1];i.getLayer().then(function(e){return a.addLayer(e),a.addLayerInfo({title:r.title||e.name,layer:e,hideLayers:r.hideLayers?r.hideLayers.split(","):void 0,defaultSymbol:r.defaultSymbol?JSON.parse(r.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(t,r){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(t,n,i,a){var o=a[0],s=i.targetId||i.id,c=r.defer();require(["esri/dijit/Legend","dijit/registry"],function(r,n){o.getMap().then(function(i){var a={map:i},u=o.getLayerInfos();u&&(a.layerInfos=u);var l=n.byId(s);l&&l.destroyRecursive(),l=new r(a,s),l.startup(),t.layers=l.layers,e.forEach(t.layers,function(e,r){t.$watch("layers["+r+"].renderer",function(){l.refresh()})}),c.resolve(l)})})}}}])}(angular);